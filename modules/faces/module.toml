name = "faces"
description = "Face detection from the RGB camera with embeddings"

[pilot]
display_name = "Faces"
description = "Detects faces, publishes crops, and emits embeddings"
regimes = ["perception"]

[[pilot.topics]]
name = "/vision/faces"
type = "faces_msgs/msg/FaceDetections"
access = "ro"
presentation = "json"
qos = { history = "keep_last", depth = 3, reliability = "best_effort", durability = "volatile" }

[[pilot.topics]]
name = "/vision/face_detected"
type = "std_msgs/msg/String"
access = "ro"
presentation = "text"
qos = { history = "keep_last", depth = 5, reliability = "reliable", durability = "volatile" }

[[actions]]
type = "link_packages"
packages = ["faces", "faces_msgs"]

[[actions]]
type = "pip_install"
packages = ["opencv-python", "numpy", "cv2"]
import_check = ["cv2", "numpy"]
break_system = true

[systemd]
description = "Psyched Face Detection"
after = ["network-online.target"]
wants = ["network-online.target"]
restart = "on-failure"
restart_sec = 5
launch_command = "${MODULE_DIR}/faces.launch.sh"
shutdown_command = "${MODULE_DIR}/faces.shutdown.sh"
