#!/usr/bin/env bash
set -euo pipefail

REPO_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
HOST_SHORT="${HOST:-$(hostname -s)}"

if ! command -v deno >/dev/null 2>&1; then
  echo "[setup] deno is required to run module provisioning. Install from https://deno.land/ before continuing." >&2
  exit 1
fi

exec deno run -A "${REPO_DIR}/psh/main.ts" setup "${HOST_SHORT}"
